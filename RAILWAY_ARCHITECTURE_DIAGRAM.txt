================================================================================
                    UNILINGO RAILWAY BACKEND ARCHITECTURE
                          Current State (v1.0)
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT LAYER                                      â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Mobile Apps   â”‚  â”‚  Web Browser   â”‚  â”‚   Other APIs   â”‚            â”‚
â”‚  â”‚  (React Native)â”‚  â”‚                â”‚  â”‚                â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚          â”‚                   â”‚                    â”‚                      â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                              â”‚                                           â”‚
â”‚                         HTTPS Requests                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      RAILWAY PLATFORM                                     â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    WEB SERVICE (Port 8080)                         â”‚  â”‚
â”‚  â”‚                    Single Node.js Instance                         â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚                 EXPRESS.JS SERVER                            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                              â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚          RATE LIMITING LAYER                 â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ IP-based: 100 req/15min                   â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ User-based (Pronunciation): 100 req/hour  â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ User-based (AI): 200 req/hour             â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                     â–¼                                        â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚         HTTP ENDPOINT HANDLERS               â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚          (Async/Await Pattern)               â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                              â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ POST /api/ai/generate-flashcards      â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   â”œâ”€â–º OpenAI Queue (5-30s)             â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   â””â”€â–º Blocks HTTP response âŒ          â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ POST /api/ai/generate-lesson          â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   â”œâ”€â–º Multiple OpenAI calls (30-60s)   â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   â””â”€â–º Blocks HTTP response âŒ          â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ POST /api/pronunciation-assess        â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   â”œâ”€â–º Azure Speech Queue (2-10s)       â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   â””â”€â–º Blocks HTTP response âŒ          â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ POST /api/process-image               â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   â”œâ”€â–º Azure Vision OCR (1-3s)          â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   â””â”€â–º Blocks HTTP response âŒ          â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ POST /api/process-pdf                 â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   â”œâ”€â–º Local pdf-parse (5-20s)          â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   â””â”€â–º Blocks HTTP response âŒ          â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                     â–¼                                        â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚        IN-MEMORY QUEUE LAYER                 â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                              â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ OpenAI Request Queue                  â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Sequential processing (1 at a time)â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ 50 req/min, 75k tokens/min         â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Circuit breaker (5 failures)       â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Lost on restart âŒ                 â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                              â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Azure Speech Request Queue            â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Parallel (max 20 concurrent)       â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Circuit breaker (5 failures)       â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Lost on restart âŒ                 â”‚ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                              â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                           â”‚
â”‚  âŒ No Worker Service                                                     â”‚
â”‚  âŒ No Redis/Queue System                                                 â”‚
â”‚  âŒ No Auto-scaling Configuration                                         â”‚
â”‚  âŒ No Background Job Processing                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    External API Calls (Inline)
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EXTERNAL SERVICES                                    â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    OpenAI API       â”‚  â”‚  Azure Cognitive     â”‚  â”‚  AWS Services   â”‚ â”‚
â”‚  â”‚                     â”‚  â”‚    Services          â”‚  â”‚                 â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  GPT-4o-mini  â”‚  â”‚  â”‚  â”‚ Speech Service â”‚ â”‚  â”‚  â”‚  Polly    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚               â”‚  â”‚  â”‚  â”‚  (Pronunciationâ”‚ â”‚  â”‚  â”‚  (TTS)    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ 5-30s/request â”‚  â”‚  â”‚  â”‚   Assessment)  â”‚ â”‚  â”‚  â”‚ 2-15s/req â”‚  â”‚ â”‚
â”‚  â”‚  â”‚               â”‚  â”‚  â”‚  â”‚  2-10s/request â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚  â”‚ 50 req/min    â”‚  â”‚  â”‚  â”‚                â”‚ â”‚  â”‚                 â”‚ â”‚
â”‚  â”‚  â”‚ 75k tok/min   â”‚  â”‚  â”‚  â”‚ Max 20         â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚               â”‚  â”‚  â”‚  â”‚ concurrent     â”‚ â”‚  â”‚  â”‚    S3     â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚  Storage  â”‚  â”‚ â”‚
â”‚  â”‚                     â”‚  â”‚                      â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚  Circuit Breaker:   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚                 â”‚ â”‚
â”‚  â”‚  â€¢ Threshold: 5     â”‚  â”‚  â”‚ Computer Visionâ”‚ â”‚  â”‚                 â”‚ â”‚
â”‚  â”‚  â€¢ Timeout: 60s     â”‚  â”‚  â”‚      OCR       â”‚ â”‚  â”‚                 â”‚ â”‚
â”‚  â”‚                     â”‚  â”‚  â”‚                â”‚ â”‚  â”‚                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ 1-3s/request   â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚  â”‚                â”‚ â”‚                       â”‚
â”‚                           â”‚  â”‚ 5k free/month  â”‚ â”‚                       â”‚
â”‚                           â”‚  â”‚                â”‚ â”‚                       â”‚
â”‚                           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                       â”‚
â”‚                           â”‚                      â”‚                       â”‚
â”‚                           â”‚  Circuit Breaker:    â”‚                       â”‚
â”‚                           â”‚  â€¢ Threshold: 5      â”‚                       â”‚
â”‚                           â”‚  â€¢ Timeout: 60s      â”‚                       â”‚
â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      Supabase                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚   PostgreSQL     â”‚  â”‚  Storage Bucket  â”‚  â”‚   Auth Service   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ esp_lessons   â”‚  â”‚  â€¢ Audio_Lessons â”‚  â”‚  â€¢ User mgmt     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ lesson_vocab  â”‚  â”‚  â€¢ User uploads  â”‚  â”‚                  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ audio_lessons â”‚  â”‚                  â”‚  â”‚                  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ users         â”‚  â”‚                  â”‚  â”‚                  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  Fast queries    â”‚  â”‚  Public access   â”‚  â”‚  JWT tokens      â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
                          DATA FLOW EXAMPLE
                   (User generates flashcards)
================================================================================

1. Mobile App sends POST /api/ai/generate-flashcards
   â”œâ”€ Content: 5000 characters
   â”œâ”€ Subject: Medical Terminology
   â””â”€ User ID: abc123

2. Railway receives request
   â”œâ”€ IP rate limiter: âœ… 15/100 used
   â””â”€ User rate limiter: âœ… 42/200 used

3. Request enters OpenAI queue
   â”œâ”€ Queue position: 1
   â”œâ”€ Current queue size: 3 requests waiting
   â””â”€ Estimated wait: 45 seconds

4. OpenAI API call (blocking)
   â”œâ”€ Sends 5000 chars to GPT-4o-mini
   â”œâ”€ Waits 18 seconds for response â³
   â””â”€ Receives 40 flashcards

5. Response sent to client
   â”œâ”€ Total time: 18 seconds
   â””â”€ User waited entire time âŒ

ğŸš¨ Problem: During those 18 seconds, 3 other users were also waiting!


================================================================================
                        BOTTLENECK VISUALIZATION
================================================================================

Timeline: 10 users submit AI requests simultaneously at t=0

Without Worker Queue (Current):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
User 1: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 20s âœ“
User 2:                       [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 19s âœ“
User 3:                                          [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 12s âœ“
User 4:                                                        [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 7s âœ“
User 5:                                                                [â–ˆâ–ˆ] 2s âœ“
User 6:                                                                  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 5s âœ“
User 7:                                                                        [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 5s âœ“
User 8:                                                                              [â–ˆâ–ˆâ–ˆ] 3s âœ“
User 9:                                                                                  [â–ˆâ–ˆâ–ˆâ–ˆ] 4s âœ“
User 10:                                                                                     [â–ˆâ–ˆ] 2s â³

Total time: 79 seconds for 10 users
Average wait: 7.9 seconds per user
Users waiting: Everyone blocks until their turn


With Worker Queue (Recommended):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
All Users: [âœ“] 0.2s - Job queued, ID returned
           [Background processing...]
           [Webhook notification when done]

Total time: 0.2 seconds for all users
Average wait: 0.02 seconds per user
Background processing: 20 seconds (doesn't block HTTP)


================================================================================
                    CONCURRENT REQUESTS HANDLING
================================================================================

Current System (1 Instance):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Express.js Event Loop                         â”‚
â”‚                                                                â”‚
â”‚  Request 1 (AI)         â”€â”€â–º OpenAI Queue â”€â”€â–º [â³ 18s blocking] â”‚
â”‚  Request 2 (AI)         â”€â”€â–º Wait in queue â”€â”€â–º [â³ 15s blocking]â”‚
â”‚  Request 3 (Pronunciation) â–º Azure Queue â”€â”€â–º [â³ 5s blocking] â”‚
â”‚  Request 4 (Pronunciation) â–º Processing â”€â”€â–º [â³ 7s blocking]   â”‚
â”‚  Request 5 (OCR)        â”€â”€â–º Azure OCR â”€â”€â”€â”€â–º [â³ 2s blocking]   â”‚
â”‚  Request 6 (Health)     â”€â”€â–º [âœ“ 50ms]                           â”‚
â”‚                                                                â”‚
â”‚  OpenAI: Sequential (1 at a time)                             â”‚
â”‚  Azure Speech: Parallel (max 20)                              â”‚
â”‚  Azure OCR: Direct                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Result: Requests 1 and 2 take 33 seconds total (18+15)
        Requests 3 and 4 can run in parallel


================================================================================
                        RATE LIMIT ENFORCEMENT
================================================================================

Current (In-Memory per Instance):

Instance 1:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IP-based Rate Limits       â”‚
â”‚ 192.168.1.1: 45/100        â”‚
â”‚ 192.168.1.2: 89/100        â”‚
â”‚                            â”‚
â”‚ User-based Rate Limits     â”‚
â”‚ user_abc: 12/200 (AI)      â”‚
â”‚ user_abc: 5/100 (Speech)   â”‚
â”‚ user_xyz: 156/200 (AI)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

If scaled to multiple instances:
Instance 1 and Instance 2 have SEPARATE counters âŒ
User could bypass limits by hitting different instances!

Recommended (Redis):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Shared Redis Store     â”‚
â”‚                            â”‚
â”‚ All instances read/write   â”‚
â”‚ Same rate limit counters   â”‚
â”‚ Distributed enforcement âœ“  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
                      FAILURE SCENARIOS
================================================================================

Scenario 1: OpenAI Rate Limit Hit
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. 50 requests in 1 minute â†’ OpenAI returns 429
2. Circuit breaker opens (after 5 failures)
3. All AI requests blocked for 60 seconds ğŸš¨
4. Users see: "Rate limit exceeded. Try again later."

Impact: Complete AI service outage for 1 minute


Scenario 2: Railway Instance Restart
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Railway deploys new code or restarts instance
2. In-memory queues lost (OpenAI queue: 3 requests) ğŸš¨
3. In-memory rate limits reset
4. Circuit breaker state reset

Impact: Lost requests, users get errors


Scenario 3: Azure Speech Overload
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. 25 pronunciation requests arrive simultaneously
2. 20 process immediately (max concurrent)
3. 5 wait in queue
4. User 1-20: Average 5 seconds
5. User 21-25: Wait 5s + their processing time

Impact: Some users experience 10+ second delays


================================================================================
                      MONITORING & OBSERVABILITY
================================================================================

Available Endpoints (IP whitelisted):

GET /api/health                    - Basic health check
GET /api/health/detailed           - Full system health
GET /api/metrics                   - Performance metrics
GET /api/pronunciation/status      - Speech service status
GET /api/ai/status                 - OpenAI service status
GET /api/admin/users/overview      - User activity
GET /api/admin/users/statistics    - Usage statistics
GET /monitoring                    - HTML dashboard

Metrics Tracked:
â€¢ Total requests
â€¢ Average response time
â€¢ Error rate
â€¢ Per-service metrics (OpenAI, Azure Speech, Azure OCR)
â€¢ Circuit breaker state
â€¢ Queue sizes
â€¢ User activity and risk scores


================================================================================
                    RECOMMENDED ARCHITECTURE
                       (Future State)
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT LAYER                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      RAILWAY PLATFORM                                     â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            WEB SERVICE (Auto-scale 1-5 instances)                  â”‚  â”‚
â”‚  â”‚  â€¢ Handles HTTP requests                                           â”‚  â”‚
â”‚  â”‚  â€¢ Returns job IDs immediately                                     â”‚  â”‚
â”‚  â”‚  â€¢ No blocking operations âœ“                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                â”‚                                          â”‚
â”‚                                â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     REDIS (Queue + Cache)                           â”‚ â”‚
â”‚  â”‚  â€¢ Job queue (BullMQ)                                               â”‚ â”‚
â”‚  â”‚  â€¢ Rate limiting (shared)                                           â”‚ â”‚
â”‚  â”‚  â€¢ Circuit breaker state                                            â”‚ â”‚
â”‚  â”‚  â€¢ Response cache                                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                â”‚                                          â”‚
â”‚                                â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚          WORKER SERVICE (Auto-scale 1-3 instances)                  â”‚ â”‚
â”‚  â”‚  â€¢ Process background jobs                                          â”‚ â”‚
â”‚  â”‚  â€¢ OpenAI requests (parallel: 5 concurrent)                         â”‚ â”‚
â”‚  â”‚  â€¢ Audio generation (Polly)                                         â”‚ â”‚
â”‚  â”‚  â€¢ Long-running operations                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                        External APIs (same as current)


Benefits:
âœ… Instant HTTP responses (< 200ms)
âœ… No blocking operations
âœ… Horizontal scaling works correctly
âœ… Persistent queues (survive restarts)
âœ… Better resource utilization
âœ… Can handle 10x more traffic


================================================================================
                       COST-BENEFIT ANALYSIS
================================================================================

Current System:
â”œâ”€ Railway Web Service: $10-20/month
â”œâ”€ External APIs: $30-50/month
â””â”€ Total: $40-70/month

Handles: ~100 active users
Max concurrent requests: ~20/minute with AI

Recommended System:
â”œâ”€ Railway Web Service (auto-scale): $15-40/month
â”œâ”€ Railway Worker Service (auto-scale): $15-40/month
â”œâ”€ Railway Redis Plugin: $10/month
â”œâ”€ External APIs: $30-50/month
â””â”€ Total: $70-140/month

Handles: ~1,000 active users
Max concurrent requests: ~200/minute with AI

ROI: 10x capacity for 2x cost


================================================================================
                      IMPLEMENTATION TIMELINE
================================================================================

Week 1: Foundation
â”œâ”€ Add Redis to Railway
â”œâ”€ Install BullMQ
â”œâ”€ Create worker.js
â””â”€ Migrate flashcard generation

Week 2: Migration
â”œâ”€ Move lesson generation to worker
â”œâ”€ Move audio generation to worker
â”œâ”€ Add job status endpoints
â””â”€ Update frontend polling

Week 3: Scaling
â”œâ”€ Enable auto-scaling
â”œâ”€ Redis-based rate limiting
â”œâ”€ APM integration (Sentry)
â””â”€ Alert configuration

Week 4: Optimization
â”œâ”€ Parallel OpenAI processing
â”œâ”€ Response caching
â”œâ”€ Load testing
â””â”€ Documentation


================================================================================
                           CONCLUSION
================================================================================

Current State:
âŒ Single instance, no scaling
âŒ All API calls block HTTP responses
âŒ In-memory queues (lost on restart)
âŒ Sequential OpenAI processing
âŒ Risk of timeouts under load

Recommended State:
âœ… Auto-scaling web + worker services
âœ… Redis-backed persistent queues
âœ… Instant HTTP responses (job IDs)
âœ… Background processing
âœ… 10x capacity, 2x cost

Critical Next Steps:
1. Add Redis
2. Create worker service
3. Migrate long-running operations
4. Enable auto-scaling


Report Date: October 12, 2025
Version: 1.0

